# 中断的引入

## 异常与终端处理流程

- 查询方式
- 休眠-唤醒方式
- poll方式
- 异步通知方式

后三种方式均需要引入中断的概念

## 中断处理

中断属于一种异常,处理逻辑大致为

- 保存现场
- 处理异常
- 恢复现场

## arm架构中的中断

### 中断控制器

### 中断源

中断源包含 按键,定时器,网络数据等.

### 对异常鹤中断的使用过程

- 初始化
  1. 设置中断源
  2. 设置中断控制器（需要设置屏蔽和优先级）
  3. 设置CPU（CPU中存在总开关，使能中断）

- 执行程序
- 产生中断，如按下按键：

~~~
    按键->中断控制器->CPU
~~~

- CPU每执行完一条指令,都会检查有无中断产生,有无异常产生,
- 发现有中断产生,有异常产生,则进行处理

<font color=eeddff>对于不用的异常 跳去不同地址执行程序,地址上,是跳转指令,跳去执行某个函数</font>


## Linux 系统对中断的处理

### 进程、线程、中断的核心：栈

### ARM处理器运行过程

arm芯片属于精简指令集计算机，使用的指令比较简单，特点如下：

1. 对内存的操作只有读、写指令
2. 对于数据的运算在CPU内部实现
3. 使用RISC指令的CPU复杂度小，易于设计
   
一个小例子 a = a + b 翻译为4条指令：
    
    1. read a from addr{a} into reg0
    2. read b from addr{b} into reg1
    3. add reg0 and reg1 into reg0
    4. write reg0 into addr{a}

运行过程中，例如运行到第二步结束，触发中断，那么首先将寄存器的值保存到栈中。称为保存现场；等待中断处理完成后再从栈中恢复现场。